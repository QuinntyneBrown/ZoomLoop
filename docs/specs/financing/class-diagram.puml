@startuml Financing Class Diagram

skinparam classAttributeIconSize 0
skinparam classFontStyle bold

package "Financing Domain" {

    class FinancingApplication {
        +id: String
        +customerId: String
        +vehicleId: String
        +requestedAmount: Decimal
        +status: ApplicationStatus
        +creditScore: Integer
        +submittedAt: DateTime
        +decidedAt: DateTime
    }

    enum ApplicationStatus {
        DRAFT
        SUBMITTED
        UNDER_REVIEW
        APPROVED
        DECLINED
        NEEDS_INFO
        COMPLETED
    }

    class PersonalInfo {
        +legalName: String
        +dateOfBirth: Date
        +sin: String
        +address: Address
        +timeAtAddress: Duration
        +housingStatus: String
        +monthlyPayment: Decimal
    }

    class EmploymentInfo {
        +status: EmploymentStatus
        +employer: String
        +jobTitle: String
        +timeAtEmployer: Duration
        +annualIncome: Decimal
        +additionalIncome: Decimal
    }

    enum EmploymentStatus {
        EMPLOYED
        SELF_EMPLOYED
        RETIRED
        STUDENT
        OTHER
    }

    class CreditCheck {
        +authorized: Boolean
        +authorizedAt: DateTime
        +score: Integer
        +retrievedAt: DateTime
    }

    class FinancingOption {
        +id: String
        +applicationId: String
        +lenderId: String
        +lenderName: String
        +apr: Decimal
        +term: Integer
        +monthlyPayment: Decimal
        +downPayment: Decimal
        +financeAmount: Decimal
        +totalInterest: Decimal
        +totalCost: Decimal
        +isRecommended: Boolean
        +expiresAt: DateTime
    }

    class Loan {
        +id: String
        +applicationId: String
        +optionId: String
        +customerId: String
        +vehicleId: String
        +lenderId: String
        +principal: Decimal
        +apr: Decimal
        +term: Integer
        +monthlyPayment: Decimal
        +firstPaymentDate: DateTime
        +status: LoanStatus
    }

    enum LoanStatus {
        PENDING_SIGNATURE
        SIGNED
        DISBURSED
        ACTIVE
        PAID_OFF
        DEFAULTED
    }

    FinancingApplication "1" --> "1" PersonalInfo : has
    FinancingApplication "1" --> "1" EmploymentInfo : has
    FinancingApplication "1" --> "0..1" CreditCheck : may have
    FinancingApplication "1" --> "*" FinancingOption : generates
    FinancingApplication "1" --> "0..1" Loan : results in
    FinancingApplication --> ApplicationStatus
    EmploymentInfo --> EmploymentStatus
    Loan --> LoanStatus
}

@enduml
