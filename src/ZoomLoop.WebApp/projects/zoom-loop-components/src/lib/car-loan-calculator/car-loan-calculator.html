<div class="car-loan-calculator">
  <h2 class="car-loan-calculator__title">{{ title() }}</h2>
  <p class="car-loan-calculator__subtitle">{{ subtitle() }}</p>

  <div class="car-loan-calculator__body">
    <div class="car-loan-calculator__inputs">
      <!-- Vehicle Price -->
      <div class="car-loan-calculator__input-group">
        <label class="car-loan-calculator__label" for="vehiclePrice">Vehicle Price</label>
        <div class="car-loan-calculator__input-wrapper car-loan-calculator__input-wrapper--prefix">
          <span class="car-loan-calculator__input-addon">$</span>
          <input
            class="car-loan-calculator__input"
            type="number"
            id="vehiclePrice"
            [ngModel]="vehiclePrice()"
            (ngModelChange)="vehiclePrice.set($event)"
            [min]="minVehiclePrice()"
            [max]="maxVehiclePrice()"
            step="500"
          />
        </div>
        <input
          class="car-loan-calculator__slider"
          type="range"
          [ngModel]="vehiclePrice()"
          (ngModelChange)="vehiclePrice.set($event)"
          [min]="minVehiclePrice()"
          [max]="maxVehiclePrice()"
          step="500"
        />
        <div class="car-loan-calculator__range-labels">
          <span>{{ minVehiclePrice() | currency: 'CAD' : 'symbol' : '1.0-0' }}</span>
          <span>{{ maxVehiclePrice() | currency: 'CAD' : 'symbol' : '1.0-0' }}</span>
        </div>
      </div>

      <!-- Down Payment -->
      <div class="car-loan-calculator__input-group">
        <label class="car-loan-calculator__label" for="downPayment">Down Payment</label>
        <div class="car-loan-calculator__input-wrapper car-loan-calculator__input-wrapper--prefix">
          <span class="car-loan-calculator__input-addon">$</span>
          <input
            class="car-loan-calculator__input"
            type="number"
            id="downPayment"
            [ngModel]="downPayment()"
            (ngModelChange)="downPayment.set($event)"
            [min]="0"
            [max]="maxDownPayment()"
            step="500"
          />
        </div>
        <input
          class="car-loan-calculator__slider"
          type="range"
          [ngModel]="downPayment()"
          (ngModelChange)="downPayment.set($event)"
          [min]="0"
          [max]="maxDownPayment()"
          step="500"
        />
        <div class="car-loan-calculator__range-labels">
          <span>{{ 0 | currency: 'CAD' : 'symbol' : '1.0-0' }}</span>
          <span>{{ maxDownPayment() | currency: 'CAD' : 'symbol' : '1.0-0' }}</span>
        </div>
      </div>

      <!-- Trade-in Value -->
      <div class="car-loan-calculator__input-group">
        <label class="car-loan-calculator__label" for="tradeInValue">Trade-in Value</label>
        <div class="car-loan-calculator__input-wrapper car-loan-calculator__input-wrapper--prefix">
          <span class="car-loan-calculator__input-addon">$</span>
          <input
            class="car-loan-calculator__input"
            type="number"
            id="tradeInValue"
            [ngModel]="tradeInValue()"
            (ngModelChange)="tradeInValue.set($event)"
            [min]="0"
            [max]="maxTradeInValue()"
            step="500"
          />
        </div>
        <input
          class="car-loan-calculator__slider"
          type="range"
          [ngModel]="tradeInValue()"
          (ngModelChange)="tradeInValue.set($event)"
          [min]="0"
          [max]="maxTradeInValue()"
          step="500"
        />
        <div class="car-loan-calculator__range-labels">
          <span>{{ 0 | currency: 'CAD' : 'symbol' : '1.0-0' }}</span>
          <span>{{ maxTradeInValue() | currency: 'CAD' : 'symbol' : '1.0-0' }}</span>
        </div>
      </div>

      <!-- Interest Rate -->
      <div class="car-loan-calculator__input-group">
        <label class="car-loan-calculator__label" for="interestRate">Interest Rate (APR)</label>
        <div class="car-loan-calculator__input-wrapper car-loan-calculator__input-wrapper--suffix">
          <input
            class="car-loan-calculator__input"
            type="number"
            id="interestRate"
            [ngModel]="interestRate()"
            (ngModelChange)="interestRate.set($event)"
            [min]="minInterestRate()"
            [max]="maxInterestRate()"
            step="0.1"
          />
          <span class="car-loan-calculator__input-addon">%</span>
        </div>
        <input
          class="car-loan-calculator__slider"
          type="range"
          [ngModel]="interestRate()"
          (ngModelChange)="interestRate.set($event)"
          [min]="minInterestRate()"
          [max]="maxInterestRate()"
          step="0.1"
        />
        <div class="car-loan-calculator__range-labels">
          <span>{{ minInterestRate() }}%</span>
          <span>{{ maxInterestRate() }}%</span>
        </div>
      </div>

      <!-- Loan Term -->
      <div class="car-loan-calculator__input-group">
        <label class="car-loan-calculator__label" for="loanTerm">Loan Term</label>
        <div class="car-loan-calculator__input-wrapper car-loan-calculator__input-wrapper--suffix">
          <input
            class="car-loan-calculator__input"
            type="number"
            id="loanTerm"
            [ngModel]="loanTermMonths()"
            (ngModelChange)="loanTermMonths.set($event)"
            [min]="minLoanTermMonths()"
            [max]="maxLoanTermMonths()"
            step="12"
          />
          <span class="car-loan-calculator__input-addon">months</span>
        </div>
        <input
          class="car-loan-calculator__slider"
          type="range"
          [ngModel]="loanTermMonths()"
          (ngModelChange)="loanTermMonths.set($event)"
          [min]="minLoanTermMonths()"
          [max]="maxLoanTermMonths()"
          step="12"
        />
        <div class="car-loan-calculator__range-labels">
          <span>{{ minLoanTermMonths() / 12 }} yr</span>
          <span>{{ maxLoanTermMonths() / 12 }} yrs</span>
        </div>
      </div>

      <!-- Payment Frequency -->
      <div class="car-loan-calculator__input-group">
        <label class="car-loan-calculator__label">Payment Frequency</label>
        <div class="car-loan-calculator__frequency-toggle">
          <button
            type="button"
            class="car-loan-calculator__frequency-btn"
            [class.car-loan-calculator__frequency-btn--active]="paymentFrequency() === 'monthly'"
            (click)="paymentFrequency.set('monthly')"
          >
            Monthly
          </button>
          <button
            type="button"
            class="car-loan-calculator__frequency-btn"
            [class.car-loan-calculator__frequency-btn--active]="paymentFrequency() === 'bi-weekly'"
            (click)="paymentFrequency.set('bi-weekly')"
          >
            Bi-weekly
          </button>
        </div>
      </div>
    </div>

    <div class="car-loan-calculator__results">
      <div class="car-loan-calculator__result-card car-loan-calculator__result-card--primary">
        <span class="car-loan-calculator__result-label">
          {{ paymentFrequency() === 'monthly' ? 'Monthly' : 'Bi-weekly' }} Payment
        </span>
        <span class="car-loan-calculator__result-value">
          {{ calculation().paymentAmount | currency: 'CAD' : 'symbol' : '1.2-2' }}
        </span>
      </div>

      <div class="car-loan-calculator__result-card">
        <span class="car-loan-calculator__result-label">Loan Amount</span>
        <span class="car-loan-calculator__result-value">
          {{ calculation().effectiveLoanAmount | currency: 'CAD' : 'symbol' : '1.0-0' }}
        </span>
      </div>

      <div class="car-loan-calculator__result-card">
        <span class="car-loan-calculator__result-label">Total Interest</span>
        <span class="car-loan-calculator__result-value">
          {{ calculation().totalInterest | currency: 'CAD' : 'symbol' : '1.2-2' }}
        </span>
      </div>

      <div class="car-loan-calculator__result-card">
        <span class="car-loan-calculator__result-label">Total Cost of Loan</span>
        <span class="car-loan-calculator__result-value">
          {{ calculation().totalLoanCost | currency: 'CAD' : 'symbol' : '1.2-2' }}
        </span>
      </div>

      <div class="car-loan-calculator__result-card">
        <span class="car-loan-calculator__result-label">Number of Payments</span>
        <span class="car-loan-calculator__result-value">{{ calculation().numberOfPayments }}</span>
      </div>

      @if (showApplyButton()) {
        <button class="car-loan-calculator__apply-btn" (click)="onApplyClick()">
          {{ applyButtonText() }}
        </button>
      }
    </div>
  </div>
</div>
